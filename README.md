# Coding Boilerplate (npm only)

npmのみで動作する、静的コーディング用ボイラープレートです。
開発時はHTMLタグベースのインクルード機能が使え、ビルド後は `.php` ファイルとして出力されます。

## 開発フローの概要

本プロジェクトは、以下の流れで進行します。

1. **準備**
   最初に一度だけ、必要なツールのインストールを行います。

2. **開発・修正**
   専用のコマンドで開発モードを起動し、ブラウザでプレビューを確認しながら `src` フォルダ内のファイルを編集します。保存するたびにブラウザが自動更新されます。

3. **納品データ作成**
   作業完了後、ビルドコマンドを実行することで `public` フォルダに納品用（本番用）データが自動生成されます。この `public` フォルダの中身を使用します。

## 前提条件
- Node.js (v18以上推奨) がインストールされていること。

## インストール

```bash
npm install
```

## 開発コマンド

### ローカルサーバー起動 (開発中)
```bash
npm run dev
```
- `http://localhost:3000` でプレビューできます。
- `<include src="...">` タグは自動的に結合されて表示されます。
- SCSSやJSの変更はリアルタイムに反映されます。

### ビルド (納品用出力)
```bash
npm run build
```
- `src` 内のファイルがコンパイルされ、`public` ディレクトリに出力されます。
- `.html` ファイルは自動的に `.php` にリネームされます。
- `static` ディレクトリの中身が `public` にコピーされます。
- 画像ファイルは自動的に圧縮・最適化されます。

## ディレクトリ構成

```
project-root/
├── src/                # 開発ディレクトリ
│   ├── assets/
│   │   ├── scss/       # SCSS (FLOCSS構成)
│   │   │   ├── foundation/ # 変数, Mixin, リセット
│   │   │   ├── layout/     # ヘッダー, フッターなど
│   │   │   ├── project/    # ページ固有スタイル
│   │   │   └── components/ # 共通パーツのスタイル
│   │   └── js/         # JavaScript
│   ├── components/     # 共通パーツ (<include>用)
│   ├── config/         # 設定ファイル (meta.json)
│   ├── contact/        # お問い合わせページ
│   ├── news/           # お知らせページ
│   └── index.html      # トップページ
├── static/             # 静的素材 (favicon, imagesなど)
│   └── (ビルド時に public/ へそのままコピーされます)
└── public/             # 【自動生成】納品用ディレクトリ (ビルド時に生成)
```

## SCSS設計 (FLOCSSベース)

`src/assets/scss/style.scss` で一括管理していますが、各ディレクトリの役割は以下の通りです。

- **foundation**: `_variable.scss` (変数), `_mixin.scss`, `_base.scss` (リセットCSS)
- **layout**: ヘッダー、フッター、サイドバーなど、共通のレイアウト枠。
- **project**: 各ページ固有のスタイル。`project` 配下のファイルは `style.scss` で自動的に読み込まれます。
- **components**: ボタン、カードなど、再利用可能なパーツ。
- **utility**: `u-mb-20`, `u-hidden-sp` など、単一のスタイル調整用クラス。

### 画像・静的ファイルの扱い

> [!CAUTION]
> **【重要】Gulp経験者の方へ**
> Gulp環境では `src/images` に画像を置くのが一般的でしたが、**本環境(Vite)では `static/` フォルダ配下に置いてください。**
> `src` に画像を置くと、ビルド時にファイル名が変わったり、ディレクトリ構造が平坦化されて消失する恐れがあります。

### `src/` 内に置くもの
- SCSSやJSから参照される画像やフォント。
- バンドラーによって処理（ファイル名ハッシュ化やインライン化など）が必要な場合。
- **※現在の設定では、画像類は `static` 推奨です。**

### `static/` 内に置くもの
- `<img>` タグで直接読み込む画像 (`<img src="/assets/images/logo.png">` など)。
- favicon や robots.txt。
- ビルド時に `public/` ディレクトリにそのまま構造を保ってコピーされます。

**推奨ディレクトリ構成:**
```
static/
└── assets/
    └── images/
        └── (ここに画像を配置)
```
※これにより、`src/assets` 由来のファイルとURLパスの見た目を統一できます。

## 機能・使い方

### HTMLインクルード

PHPのincludeのように、外部ファイルを読み込むことができます。
タグは入れ子（再帰）呼び出しに対応しています。

```html
<!-- src/index.html -->
<include src="./components/header.html"></include>
```

- パスは **現在編集しているファイルからの相対パス** で記述してください。
- ビルド時には `<?php include '...'; ?>` に変換されます。

### メタデータ管理

`src/config/meta.json` でサイト全体のメタデータと各ページのメタデータを管理できます。
HTML内（通常は `<include src="./components/head.html">` 内）に `{{ title }}`, `{{ description }}` と記述すると、自動的に置換されます。

**設定ファイル (`src/config/meta.json`):**
```json
{
    "global": {
        "title": "サイトタイトル",
        "separator": " | "
    },
    "pages": {
        "/index.html": { "title": "トップページ" }
    }
}
```

- **自動タイトルの生成**: `ページタイトル | サイトタイトル` の形式で自動的に結合されます。
- **開発時**: HTMLに直接値が埋め込まれます。
- **ビルド時**: PHP変数 (`$page_title`, `$page_description`) として出力され、フォールバック機構付きの `echo` 文になります。

### その他の自動処理

- **リンク書き換え**: `href` や `src` 内の `.html` リンクは、ビルド時に自動的に `.php` に書き換えられます。
- **画像最適化**: ビルド時に画像ファイル (png, jpeg, webp, svg) が自動的に圧縮されます。

## 注意点
- **`public` フォルダは編集しないでください**。ビルドのたびに削除・再生成されます。
- 必ず `src` フォルダ内で作業を行ってください。

## 公開時の注意点

1. **アップロード対象**
   - **`public` フォルダの中身すべて** が公開用データです。
   - `src` フォルダなどの開発用ファイルがサーバーに残っていても問題ありませんが、Web公開領域としては `public` の中身が参照されるようにしてください。

2. **サーバー環境**
   - 本番環境では **PHPが動作すること** を確認してください。
   - すべての `.html` ファイルは `.php` に変換されています。

3. **ファイルの更新**
   - ファイルを修正する場合は、必ず手元の開発環境 (`src` 内) で修正し、`npm run build` で `public` を再生成してからアップロードしてください。
   - **サーバー上のファイルを直接編集しないでください**（次回アップロード時に開発環境の内容で上書きされてしまいます）。
